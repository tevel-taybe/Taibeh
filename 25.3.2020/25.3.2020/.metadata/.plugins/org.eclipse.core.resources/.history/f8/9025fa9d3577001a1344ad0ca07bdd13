#include <string.h>
#include <stdio.h>

#include "GlobalStandards.h"
#include "TRXVU.h"
#include "AckHandler.h"

int SendAckPacket(ack_subtype_t acksubtype, sat_packet_t *cmd,
		unsigned char *data, unsigned int length)
{
	sat_packet_t packet;
	if (cmd == NULL)
	{
		packet = {};
		memset(&packet, 0, sizeof(sat_packet_t));
	}
	else
	{
		packet = *cmd;
	}

	cmd->ID = 1;
	cmd->cmd_type = 2;
	cmd->cmd_subtype = acksubtype;
	strcpy(cmd->data, data);
	cmd->length = length;

	int avalFrames;
	int err = TransmitSplPacket(&cmd, &avalFrames);

	printf("[!] Failed to send ACK signal: %d\n", err);
	return err;
}

void SendErrorMSG(ack_subtype_t fail_subt, ack_subtype_t succ_subt,
		sat_packet_t *cmd, int err)
{
}

void SendErrorMSG_IfError(ack_subtype_t subtype, sat_packet_t *cmd, int err)
{
	//TODO: change id, type
	cmd->ID = 1;
	cmd->cmd_type = 2;
	cmd->cmd_subtype = subtype;
	cmd->data[0] = err;
	cmd->length = 1;

	int avalFrames;
	TransmitSplPacket(&cmd, &avalFrames);
}

